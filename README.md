# aws-deploy
Deploys an AWS instance using the Boto3 package for Python.
Configs are setup for installing and configuring ElasticSearch.

## Goal
Deploy an AWS instance. 
Install, configure, and secure ElasticSearch.

## Run Requirements
* AWS account with valid AWS access keys and key pair
* Python 2.7.x with `boto3`, `cryptography`, and `paramiko` packages.

## Setup
Copy `configs/template_config.json` as `configs/config.json` and modify the following entries : 
```
session.aws_access_key_id      // your access key
session.aws_secret_access_key  // your secret key
session.region_name            // your aws region
instance.KeyName               // your aws_key_pair.pem
instance.SecurityGroups        // add your list of security groups
ssh.key_path                   // /path/to/.ssh/
ftp.config_path                // /path/to/aws-deploy/configs/
ftp.script_path                // /path/to/aws-deploy/scripts/
user_auth._.username           // add your list of
user_auth._.password           //   users:passwords
```
You will need security groups that open up ports `ssh 22`, `http 80`, and `https 443`, along with a security group that allows inbound traffic on ports `9200` and `9300` from itself (the security group id).

## Deploying the Instance
With the config file set up and your security groups created : 
```
$ python deploy.py
```
The instance will be deployed to AWS based on the settings specified in `config.json`. 
A setup script and multiple config files will be uploaded to the instance.
The setup script is executed to install and configure ElasticSearch.
On success, the final line output will have the IP address of the instance.
To test that ElasticSearch is running, navigate in your web browser to the IP of the instance or run :
```
curl -k -u <user>:<password> -X GET 'https://<IP of the instance>'
```
You should receive a response similar to the following : 
```
{
  "status" : 200,
  "name" : <name generated by ElasticSearch>,
  "cluster_name" : "elasticsearch",
  "version" : {
    "number" : "1.7.3",
    "build_hash" : "NA",
    "build_timestamp" : "NA",
    "build_snapshot" : false,
    "lucene_version" : "4.10.4"
  },
  "tagline" : "You Know, for Search"
}

```
## Resources
 - lots of Googling
 - Boto 3 Docs
 - Elasticsearch docs and discussion posts
 - NGINX docs
 - stackoverflow
 - DigitalOcean Tutorials

### Reasoning, Feedback, and Questions can be found [HERE](notes/thoughts.md)
